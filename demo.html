<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¤ë¬¸ ë§¤ì¹­ í”Œë«í¼ - ë°ëª¨ v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 20px 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .nav {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .points-badge {
            background: #ffd700;
            color: #333;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }

        .nav-btn {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .nav-btn:hover {
            background: #5568d3;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            margin-right: 10px;
        }

        .btn:hover {
            background: #5568d3;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 14px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .survey-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .survey-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .survey-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .survey-desc {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .survey-info {
            font-size: 12px;
            color: #999;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            background: #28a745;
            color: white;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 10px;
        }

        .badge-points {
            background: #ffd700;
            color: #333;
        }

        .hidden {
            display: none;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .user-info {
            color: #333;
            font-size: 14px;
        }

        .success-msg {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 15px;
            border: 1px solid #c3e6cb;
        }

        .error-msg {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 15px;
            border: 1px solid #f5c6cb;
        }

        .question-builder {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background: #f8f9fa;
        }

        .question-item {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-controls {
            display: flex;
            gap: 10px;
        }

        .option-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .option-input {
            flex: 1;
        }

        .welcome {
            text-align: center;
            padding: 50px 20px;
            color: white;
        }

        .welcome h1 {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .welcome p {
            font-size: 20px;
            margin-bottom: 30px;
        }

        .answer-form {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .answer-option {
            display: block;
            padding: 10px;
            margin: 5px 0;
        }

        .answer-option input[type="radio"],
        .answer-option input[type="checkbox"] {
            margin-right: 10px;
        }

        .answer-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="container">
        <div class="welcome">
            <h1>ğŸ¯ ì„¤ë¬¸ ë§¤ì¹­ í”Œë«í¼</h1>
            <p>ì„¤ë¬¸ ì˜ë¢°ìì™€ ì°¸ì—¬ìë¥¼ ì—°ê²°í•˜ëŠ” í”Œë«í¼</p>
            <p style="font-size: 16px; margin-bottom: 20px;">âœ¨ íšŒì›ê°€ì… ì‹œ 1,000P ì§€ê¸‰! ì„¤ë¬¸ ì°¸ì—¬ë¡œ í¬ì¸íŠ¸ ì ë¦½!</p>
            <button class="btn" onclick="showLogin()">ì‹œì‘í•˜ê¸°</button>
            <br><br>
            <p style="font-size: 14px; opacity: 0.8;">
                ğŸ’¡ ì´ê²ƒì€ ë°ëª¨ ë²„ì „ì…ë‹ˆë‹¤. ëª¨ë“  ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì €ì— ì €ì¥ë©ë‹ˆë‹¤.
            </p>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="container hidden">
        <div class="card" style="max-width: 400px; margin: 100px auto;">
            <h2>ë¡œê·¸ì¸</h2>
            <div id="loginMessage"></div>
            <div class="form-group">
                <label>ì´ë©”ì¼</label>
                <input type="email" id="loginEmail" placeholder="test@example.com" value="test@example.com">
            </div>
            <div class="form-group">
                <label>ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" value="password123">
            </div>
            <button class="btn" onclick="login()">ë¡œê·¸ì¸</button>
            <button class="btn btn-secondary" onclick="showRegister()">íšŒì›ê°€ì…</button>
            <p style="margin-top: 15px; font-size: 12px; color: #666;">
                ğŸ’¡ í…ŒìŠ¤íŠ¸ ê³„ì •: test@example.com / password123
            </p>
        </div>
    </div>

    <!-- Register Screen -->
    <div id="registerScreen" class="container hidden">
        <div class="card" style="max-width: 500px; margin: 50px auto;">
            <h2>íšŒì›ê°€ì… ğŸ ê°€ì… ì‹œ 1,000P ì§€ê¸‰!</h2>
            <div id="registerMessage"></div>
            <div class="form-group">
                <label>ì´ë¦„</label>
                <input type="text" id="regName" placeholder="í™ê¸¸ë™">
            </div>
            <div class="form-group">
                <label>ì´ë©”ì¼</label>
                <input type="email" id="regEmail" placeholder="test@example.com">
            </div>
            <div class="form-group">
                <label>ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="regPassword" placeholder="8ì ì´ìƒ">
            </div>
            <div class="form-group">
                <label>ì „í™”ë²ˆí˜¸</label>
                <input type="tel" id="regPhone" placeholder="010-1234-5678">
            </div>
            <div class="form-group">
                <label>ìƒë…„ì›”ì¼</label>
                <input type="date" id="regBirthDate">
            </div>
            <div class="form-group">
                <label>ì§€ì—­</label>
                <select id="regRegion">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ì„œìš¸">ì„œìš¸</option>
                    <option value="ê²½ê¸°">ê²½ê¸°</option>
                    <option value="ì¸ì²œ">ì¸ì²œ</option>
                    <option value="ë¶€ì‚°">ë¶€ì‚°</option>
                    <option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
                </select>
            </div>
            <div class="form-group">
                <label>ì§ì—…</label>
                <select id="regJob">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="í•™ìƒ">í•™ìƒ</option>
                    <option value="íšŒì‚¬ì›">íšŒì‚¬ì›</option>
                    <option value="ì „ë¬¸ì§">ì „ë¬¸ì§</option>
                    <option value="ìì˜ì—…">ìì˜ì—…</option>
                    <option value="ì£¼ë¶€">ì£¼ë¶€</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
            </div>
            <button class="btn" onclick="register()">ê°€ì…í•˜ê¸°</button>
            <button class="btn btn-secondary" onclick="showLogin()">ë¡œê·¸ì¸ìœ¼ë¡œ</button>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardScreen" class="container hidden">
        <div class="header">
            <div class="logo">ğŸ¯ ì„¤ë¬¸ ë§¤ì¹­ í”Œë«í¼</div>
            <div class="nav">
                <div class="points-badge" id="userPoints">ğŸ’° 0 P</div>
                <button class="nav-btn" onclick="showDashboard()">ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-btn" onclick="showMySurveys()">ë‚´ ì„¤ë¬¸</button>
                <button class="nav-btn" onclick="showAvailableSurveys()">ì°¸ì—¬í•˜ê¸°</button>
                <button class="nav-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <div class="card">
            <h2>ì•ˆë…•í•˜ì„¸ìš”, <span id="userName"></span>ë‹˜! ğŸ‘‹</h2>
            <div class="user-info" id="userInfo"></div>
        </div>

        <div class="dashboard-stats">
            <div class="stat-card">
                <div class="stat-number" id="userPointsDisplay">0</div>
                <div class="stat-label">ğŸ’° ë³´ìœ  í¬ì¸íŠ¸</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="mySurveysCount">0</div>
                <div class="stat-label">ë‚´ê°€ ë§Œë“  ì„¤ë¬¸</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="availableSurveysCount">0</div>
                <div class="stat-label">ì°¸ì—¬ ê°€ëŠ¥ ì„¤ë¬¸</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedSurveysCount">0</div>
                <div class="stat-label">ì°¸ì—¬ ì™„ë£Œ ì„¤ë¬¸</div>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h2>ë‚´ê°€ ë§Œë“  ì„¤ë¬¸</h2>
                <button class="btn" onclick="showCreateSurvey()">+ ìƒˆ ì„¤ë¬¸ ë§Œë“¤ê¸°</button>
                <div id="mySurveysList" style="margin-top: 20px;"></div>
            </div>

            <div class="card">
                <h2>ì°¸ì—¬ ê°€ëŠ¥í•œ ì„¤ë¬¸</h2>
                <div id="availableSurveysList"></div>
            </div>
        </div>
    </div>

    <!-- Create Survey -->
    <div id="createSurveyScreen" class="container hidden">
        <div class="header">
            <div class="logo">ğŸ¯ ì„¤ë¬¸ ë§¤ì¹­ í”Œë«í¼</div>
            <div class="nav">
                <div class="points-badge" id="userPoints2">ğŸ’° 0 P</div>
                <button class="nav-btn" onclick="showDashboard()">ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <div class="card">
            <h2>ìƒˆ ì„¤ë¬¸ ë§Œë“¤ê¸° (êµ¬ê¸€ í¼ ìŠ¤íƒ€ì¼)</h2>
            <div id="createMessage"></div>

            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="form-group">
                <label>ì„¤ë¬¸ ì œëª©</label>
                <input type="text" id="surveyTitle" placeholder="ì˜ˆ: ì˜¨ë¼ì¸ ì‡¼í•‘ ë§Œì¡±ë„ ì¡°ì‚¬">
            </div>
            <div class="form-group">
                <label>ì„¤ë¬¸ ì„¤ëª…</label>
                <textarea id="surveyDesc" placeholder="ì„¤ë¬¸ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            </div>
            <div class="form-group">
                <label>ëª©í‘œ ì‘ë‹µ ìˆ˜</label>
                <input type="number" id="surveyTarget" value="100">
            </div>
            <div class="form-group">
                <label>ë³´ìƒ í¬ì¸íŠ¸</label>
                <input type="number" id="surveyRewardPoints" value="100" placeholder="ì˜ˆ: 100">
                <small style="color: #666;">ì°¸ì—¬ìì—ê²Œ ì§€ê¸‰í•  í¬ì¸íŠ¸</small>
            </div>
            <div class="form-group">
                <label>íƒ€ê¹ƒ ì§€ì—­ (ì„ íƒì‚¬í•­)</label>
                <select id="surveyTargetRegion">
                    <option value="">ì „ì²´</option>
                    <option value="ì„œìš¸">ì„œìš¸</option>
                    <option value="ê²½ê¸°">ê²½ê¸°</option>
                    <option value="ì¸ì²œ">ì¸ì²œ</option>
                    <option value="ë¶€ì‚°">ë¶€ì‚°</option>
                </select>
            </div>
            <div class="form-group">
                <label>íƒ€ê¹ƒ ì§ì—… (ì„ íƒì‚¬í•­)</label>
                <select id="surveyTargetJob">
                    <option value="">ì „ì²´</option>
                    <option value="í•™ìƒ">í•™ìƒ</option>
                    <option value="íšŒì‚¬ì›">íšŒì‚¬ì›</option>
                    <option value="ì „ë¬¸ì§">ì „ë¬¸ì§</option>
                    <option value="ìì˜ì—…">ìì˜ì—…</option>
                </select>
            </div>

            <hr style="margin: 30px 0;">

            <!-- ì§ˆë¬¸ ë¹Œë” -->
            <h3>ì„¤ë¬¸ ë¬¸í•­ ì‘ì„±</h3>
            <div id="questionsContainer"></div>

            <button class="btn btn-secondary" onclick="addQuestion()">+ ì§ˆë¬¸ ì¶”ê°€</button>
            <br><br>
            <button class="btn" onclick="createSurvey()">ì„¤ë¬¸ ìƒì„±</button>
            <button class="btn btn-secondary" onclick="showDashboard()">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- Survey Participate -->
    <div id="participateScreen" class="container hidden">
        <div class="header">
            <div class="logo">ğŸ¯ ì„¤ë¬¸ ë§¤ì¹­ í”Œë«í¼</div>
            <div class="nav">
                <div class="points-badge" id="userPoints3">ğŸ’° 0 P</div>
                <button class="nav-btn" onclick="showDashboard()">ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <div class="card">
            <h2 id="participateTitle"></h2>
            <p id="participateDesc" style="color: #666; margin-bottom: 20px;"></p>
            <div id="participateReward" style="background: #fff3cd; padding: 15px; border-radius: 5px; margin-bottom: 20px;"></div>

            <form id="participateForm">
                <div id="participateQuestions"></div>
                <button type="button" class="btn" onclick="submitSurveyAnswers()">ì œì¶œí•˜ê¸°</button>
                <button type="button" class="btn btn-secondary" onclick="showDashboard()">ì·¨ì†Œ</button>
            </form>
        </div>
    </div>

    <script>
        // ë°ì´í„° ì €ì¥ì†Œ
        let currentUser = null;
        let currentSurvey = null;
        let questions = [];
        let questionCounter = 0;

        // ì´ˆê¸°í™”
        function init() {
            initSampleSurveys();
            const user = localStorage.getItem('currentUser');
            if (user) {
                currentUser = JSON.parse(user);
                showDashboard();
            } else {
                showScreen('welcomeScreen');
            }
        }

        // ìƒ˜í”Œ ì„¤ë¬¸ ì´ˆê¸°í™”
        function initSampleSurveys() {
            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            if (surveys.length === 0) {
                const sampleSurveys = [
                    {
                        id: 'sample1',
                        creatorId: 'system',
                        title: 'ğŸ“± ëª¨ë°”ì¼ ì•± ì‚¬ìš©ì„± ì¡°ì‚¬',
                        description: 'ì¼ìƒì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë°”ì¼ ì•±ì— ëŒ€í•œ ë§Œì¡±ë„ë¥¼ ì¡°ì‚¬í•©ë‹ˆë‹¤.',
                        targetResponses: 200,
                        rewardPoints: 150,
                        targetRegion: '',
                        targetJob: '',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'radio',
                                question: 'í•˜ë£¨ì— ìŠ¤ë§ˆíŠ¸í°ì„ ì‚¬ìš©í•˜ëŠ” ì‹œê°„ì€?',
                                required: true,
                                options: ['1ì‹œê°„ ë¯¸ë§Œ', '1-3ì‹œê°„', '3-5ì‹œê°„', '5ì‹œê°„ ì´ìƒ']
                            },
                            {
                                id: 2,
                                type: 'checkbox',
                                question: 'ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì•± ìœ í˜•ì€? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['SNS', 'ì‡¼í•‘', 'ê²Œì„', 'ë‰´ìŠ¤', 'ë™ì˜ìƒ']
                            },
                            {
                                id: 3,
                                type: 'text',
                                question: 'ê°€ì¥ ìì£¼ ì‚¬ìš©í•˜ëŠ” ì•± ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”.',
                                required: true
                            },
                            {
                                id: 4,
                                type: 'radio',
                                question: 'ì „ë°˜ì ì¸ ë§Œì¡±ë„ëŠ”?',
                                required: true,
                                options: ['ë§¤ìš° ë§Œì¡±', 'ë§Œì¡±', 'ë³´í†µ', 'ë¶ˆë§Œì¡±', 'ë§¤ìš° ë¶ˆë§Œì¡±']
                            }
                        ]
                    },
                    {
                        id: 'sample2',
                        creatorId: 'system',
                        title: 'ğŸ›’ ì˜¨ë¼ì¸ ì‡¼í•‘ ê²½í—˜ ì„¤ë¬¸',
                        description: 'ì˜¨ë¼ì¸ ì‡¼í•‘ëª° ì´ìš© ê²½í—˜ê³¼ ê°œì„ ì‚¬í•­ì„ íŒŒì•…í•˜ê¸° ìœ„í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 150,
                        rewardPoints: 200,
                        targetRegion: '',
                        targetJob: 'íšŒì‚¬ì›',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'radio',
                                question: 'í•œ ë‹¬ í‰ê·  ì˜¨ë¼ì¸ ì‡¼í•‘ ë¹ˆë„ëŠ”?',
                                required: true,
                                options: ['ì£¼ 3íšŒ ì´ìƒ', 'ì£¼ 1-2íšŒ', 'ì›” 2-3íšŒ', 'ì›” 1íšŒ ë¯¸ë§Œ']
                            },
                            {
                                id: 2,
                                type: 'checkbox',
                                question: 'ì£¼ë¡œ êµ¬ë§¤í•˜ëŠ” ìƒí’ˆ ì¹´í…Œê³ ë¦¬ëŠ”? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ì˜ë¥˜/íŒ¨ì…˜', 'ì‹í’ˆ', 'ì „ìì œí’ˆ', 'ë„ì„œ/ë¬¸êµ¬', 'ìƒí™œìš©í’ˆ']
                            },
                            {
                                id: 3,
                                type: 'select',
                                question: 'ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ìš”ì†ŒëŠ”?',
                                required: true,
                                options: ['ê°€ê²©', 'ë°°ì†¡ì†ë„', 'í’ˆì§ˆ', 'í›„ê¸°', 'êµí™˜/í™˜ë¶ˆ ì •ì±…']
                            },
                            {
                                id: 4,
                                type: 'textarea',
                                question: 'ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì—ì„œ ê°œì„ ë˜ì—ˆìœ¼ë©´ í•˜ëŠ” ì ì´ ìˆë‹¤ë©´?',
                                required: false
                            }
                        ]
                    },
                    {
                        id: 'sample3',
                        creatorId: 'system',
                        title: 'â˜• ì¹´í˜ ì´ìš© ìŠµê´€ ì¡°ì‚¬',
                        description: 'ì¹´í˜ ë°©ë¬¸ ë¹ˆë„ì™€ ì„ í˜¸ë„ë¥¼ ì•Œì•„ë³´ëŠ” ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 100,
                        rewardPoints: 100,
                        targetRegion: 'ì„œìš¸',
                        targetJob: '',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'radio',
                                question: 'ì¼ì£¼ì¼ì— ì¹´í˜ ë°©ë¬¸ íšŸìˆ˜ëŠ”?',
                                required: true,
                                options: ['ê±°ì˜ ë§¤ì¼', 'ì£¼ 3-4íšŒ', 'ì£¼ 1-2íšŒ', 'ì›” 1-2íšŒ', 'ê±°ì˜ ë°©ë¬¸ ì•ˆ í•¨']
                            },
                            {
                                id: 2,
                                type: 'checkbox',
                                question: 'ì¹´í˜ë¥¼ ë°©ë¬¸í•˜ëŠ” ì£¼ìš” ëª©ì ì€? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ì»¤í”¼/ìŒë£Œ', 'ê³µë¶€/ì—…ë¬´', 'ì¹œêµ¬ ë§Œë‚¨', 'í˜¼ìë§Œì˜ ì‹œê°„', 'ë””ì €íŠ¸']
                            },
                            {
                                id: 3,
                                type: 'radio',
                                question: '1íšŒ ë°©ë¬¸ ì‹œ í‰ê·  ì§€ì¶œ ê¸ˆì•¡ì€?',
                                required: true,
                                options: ['5,000ì› ë¯¸ë§Œ', '5,000-10,000ì›', '10,000-15,000ì›', '15,000ì› ì´ìƒ']
                            }
                        ]
                    },
                    {
                        id: 'sample4',
                        creatorId: 'system',
                        title: 'ğŸ¬ OTT ì„œë¹„ìŠ¤ ì´ìš© ì‹¤íƒœ',
                        description: 'ë„·í”Œë¦­ìŠ¤, ë””ì¦ˆë‹ˆ+, ì¿ íŒ¡í”Œë ˆì´ ë“± OTT ì„œë¹„ìŠ¤ ì´ìš©ì— ëŒ€í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 250,
                        rewardPoints: 120,
                        targetRegion: '',
                        targetJob: '',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'checkbox',
                                question: 'í˜„ì¬ êµ¬ë… ì¤‘ì¸ OTT ì„œë¹„ìŠ¤ëŠ”? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ë„·í”Œë¦­ìŠ¤', 'ë””ì¦ˆë‹ˆ+', 'ì¿ íŒ¡í”Œë ˆì´', 'í‹°ë¹™', 'ì›¨ì´ë¸Œ', 'êµ¬ë… ì•ˆ í•¨']
                            },
                            {
                                id: 2,
                                type: 'radio',
                                question: 'í•˜ë£¨ í‰ê·  OTT ì‹œì²­ ì‹œê°„ì€?',
                                required: true,
                                options: ['1ì‹œê°„ ë¯¸ë§Œ', '1-2ì‹œê°„', '2-3ì‹œê°„', '3ì‹œê°„ ì´ìƒ']
                            },
                            {
                                id: 3,
                                type: 'select',
                                question: 'ì„ í˜¸í•˜ëŠ” ì½˜í…ì¸  ì¥ë¥´ëŠ”?',
                                required: true,
                                options: ['ë“œë¼ë§ˆ', 'ì˜í™”', 'ì˜ˆëŠ¥', 'ë‹¤íë©˜í„°ë¦¬', 'ì• ë‹ˆë©”ì´ì…˜']
                            },
                            {
                                id: 4,
                                type: 'radio',
                                question: 'ì›” êµ¬ë…ë£Œë¡œ ì ì •í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ê¸ˆì•¡ì€?',
                                required: true,
                                options: ['5,000ì› ì´í•˜', '5,000-10,000ì›', '10,000-15,000ì›', '15,000ì› ì´ìƒ']
                            }
                        ]
                    },
                    {
                        id: 'sample5',
                        creatorId: 'system',
                        title: 'ğŸ’ª ìš´ë™ ìŠµê´€ ì„¤ë¬¸',
                        description: 'ìš´ë™ ë¹ˆë„ì™€ ì„ í˜¸í•˜ëŠ” ìš´ë™ ìœ í˜•ì„ ì•Œì•„ë³´ëŠ” ê°„ë‹¨í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 100,
                        rewardPoints: 80,
                        targetRegion: '',
                        targetJob: '',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'radio',
                                question: 'ì¼ì£¼ì¼ì— ìš´ë™í•˜ëŠ” íšŸìˆ˜ëŠ”?',
                                required: true,
                                options: ['ê±°ì˜ ì•ˆ í•¨', 'ì£¼ 1íšŒ', 'ì£¼ 2-3íšŒ', 'ì£¼ 4íšŒ ì´ìƒ']
                            },
                            {
                                id: 2,
                                type: 'checkbox',
                                question: 'ì„ í˜¸í•˜ëŠ” ìš´ë™ ì¢…ë¥˜ëŠ”? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ê±·ê¸°/ëŸ¬ë‹', 'í—¬ìŠ¤/ì›¨ì´íŠ¸', 'ìˆ˜ì˜', 'ìš”ê°€/í•„ë¼í…ŒìŠ¤', 'êµ¬ê¸°ì¢…ëª©', 'ìì „ê±°']
                            },
                            {
                                id: 3,
                                type: 'radio',
                                question: 'ìš´ë™í•˜ëŠ” ì£¼ëœ ì´ìœ ëŠ”?',
                                required: true,
                                options: ['ê±´ê°• ê´€ë¦¬', 'ë‹¤ì´ì–´íŠ¸', 'ì²´ë ¥ ì¦ì§„', 'ìŠ¤íŠ¸ë ˆìŠ¤ í•´ì†Œ', 'ì·¨ë¯¸']
                            }
                        ]
                    },
                    {
                        id: 'sample6',
                        creatorId: 'system',
                        title: 'ğŸ• ìŒì‹ ì„ í˜¸ë„ ì¡°ì‚¬',
                        description: 'ì¢‹ì•„í•˜ëŠ” ìŒì‹ê³¼ ì‹ì‚¬ ìŠµê´€ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 150,
                        rewardPoints: 60,
                        targetRegion: '',
                        targetJob: 'í•™ìƒ',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'checkbox',
                                question: 'ì¢‹ì•„í•˜ëŠ” ìŒì‹ ì¢…ë¥˜ëŠ”? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['í•œì‹', 'ì¤‘ì‹', 'ì¼ì‹', 'ì–‘ì‹', 'ë¶„ì‹', 'íŒ¨ìŠ¤íŠ¸í‘¸ë“œ']
                            },
                            {
                                id: 2,
                                type: 'radio',
                                question: 'í•˜ë£¨ í‰ê·  ì™¸ì‹ íšŸìˆ˜ëŠ”?',
                                required: true,
                                options: ['ê±°ì˜ ì•ˆ í•¨', '1íšŒ', '2íšŒ', '3íšŒ ì´ìƒ']
                            },
                            {
                                id: 3,
                                type: 'select',
                                question: 'ì‹ì‚¬ ë©”ë‰´ ì„ íƒ ì‹œ ê°€ì¥ ì¤‘ìš”í•œ ìš”ì†ŒëŠ”?',
                                required: true,
                                options: ['ë§›', 'ê°€ê²©', 'ê±´ê°•', 'í¸ì˜ì„±', 'ë¶„ìœ„ê¸°']
                            }
                        ]
                    },
                    {
                        id: 'sample7',
                        creatorId: 'system',
                        title: 'ğŸš— ì¶œí‡´ê·¼/í†µí•™ ìˆ˜ë‹¨ ì„¤ë¬¸',
                        description: 'ì¼ìƒì ì¸ ì´ë™ ìˆ˜ë‹¨ê³¼ ì†Œìš” ì‹œê°„ì— ëŒ€í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 120,
                        rewardPoints: 90,
                        targetRegion: 'ê²½ê¸°',
                        targetJob: '',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'radio',
                                question: 'ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì´ë™ ìˆ˜ë‹¨ì€?',
                                required: true,
                                options: ['ì§€í•˜ì² ', 'ë²„ìŠ¤', 'ìê°€ìš©', 'ë„ë³´', 'ìì „ê±°/í‚¥ë³´ë“œ', 'íƒì‹œ/ì¹´í’€']
                            },
                            {
                                id: 2,
                                type: 'radio',
                                question: 'í‰ê·  í†µê·¼/í†µí•™ ì‹œê°„ì€?',
                                required: true,
                                options: ['30ë¶„ ë¯¸ë§Œ', '30ë¶„-1ì‹œê°„', '1-2ì‹œê°„', '2ì‹œê°„ ì´ìƒ']
                            },
                            {
                                id: 3,
                                type: 'checkbox',
                                question: 'ì´ë™ ì¤‘ ì£¼ë¡œ í•˜ëŠ” í™œë™ì€? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš©', 'ìŒì•… ë“£ê¸°', 'ë…ì„œ', 'ìˆ˜ë©´', 'ì—…ë¬´/ê³µë¶€', 'ì•„ë¬´ê²ƒë„ ì•ˆ í•¨']
                            }
                        ]
                    },
                    {
                        id: 'sample8',
                        creatorId: 'system',
                        title: 'ğŸ¨ ì·¨ë¯¸ ìƒí™œ ì¡°ì‚¬',
                        description: 'ì—¬ê°€ ì‹œê°„ í™œìš©ê³¼ ì·¨ë¯¸ í™œë™ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 100,
                        rewardPoints: 70,
                        targetRegion: '',
                        targetJob: '',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'checkbox',
                                question: 'í˜„ì¬ ì¦ê¸°ëŠ” ì·¨ë¯¸ëŠ”? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ìš´ë™', 'ë…ì„œ', 'ì˜í™”/ë“œë¼ë§ˆ', 'ê²Œì„', 'ìš”ë¦¬', 'ì—¬í–‰', 'ìŒì•… ê°ìƒ', 'ì‚¬ì§„/ì˜ìƒ']
                            },
                            {
                                id: 2,
                                type: 'radio',
                                question: 'ì£¼ë§ì— ì·¨ë¯¸ í™œë™ì— í• ì• í•˜ëŠ” ì‹œê°„ì€?',
                                required: true,
                                options: ['1ì‹œê°„ ë¯¸ë§Œ', '1-3ì‹œê°„', '3-5ì‹œê°„', '5ì‹œê°„ ì´ìƒ']
                            },
                            {
                                id: 3,
                                type: 'text',
                                question: 'ìƒˆë¡­ê²Œ ì‹œì‘í•˜ê³  ì‹¶ì€ ì·¨ë¯¸ê°€ ìˆë‹¤ë©´?',
                                required: false
                            }
                        ]
                    },
                    {
                        id: 'sample9',
                        creatorId: 'system',
                        title: 'ğŸ¥ ê±´ê°•ê´€ë¦¬ ì‹¤íƒœ ì¡°ì‚¬',
                        description: 'ê±´ê°• ê´€ë¦¬ì™€ ìƒí™œ ìŠµê´€ì— ëŒ€í•œ ì„¤ë¬¸ì…ë‹ˆë‹¤.',
                        targetResponses: 80,
                        rewardPoints: 110,
                        targetRegion: '',
                        targetJob: 'ì „ë¬¸ì§',
                        createdAt: new Date().toISOString(),
                        participants: 0,
                        questions: [
                            {
                                id: 1,
                                type: 'radio',
                                question: 'í‰ê·  ìˆ˜ë©´ ì‹œê°„ì€?',
                                required: true,
                                options: ['5ì‹œê°„ ë¯¸ë§Œ', '5-6ì‹œê°„', '7-8ì‹œê°„', '8ì‹œê°„ ì´ìƒ']
                            },
                            {
                                id: 2,
                                type: 'checkbox',
                                question: 'ê±´ê°•ì„ ìœ„í•´ ì‹¤ì²œí•˜ëŠ” ê²ƒì€? (ë³µìˆ˜ì„ íƒ)',
                                required: true,
                                options: ['ê·œì¹™ì ì¸ ìš´ë™', 'ê±´ê°•ì‹ ì„­ì·¨', 'ì¶©ë¶„í•œ ìˆ˜ë©´', 'ê¸ˆì—°/ê¸ˆì£¼', 'ê±´ê°•ê²€ì§„', 'íŠ¹ë³„íˆ ì—†ìŒ']
                            },
                            {
                                id: 3,
                                type: 'radio',
                                question: 'ìŠ¤íŠ¸ë ˆìŠ¤ ìˆ˜ì¤€ì€?',
                                required: true,
                                options: ['ë§¤ìš° ë†’ìŒ', 'ë†’ìŒ', 'ë³´í†µ', 'ë‚®ìŒ', 'ë§¤ìš° ë‚®ìŒ']
                            }
                        ]
                    }
                ];
                localStorage.setItem('surveys', JSON.stringify(sampleSurveys));
            }
        }

        // í™”ë©´ ì „í™˜
        function showScreen(screenId) {
            const screens = ['welcomeScreen', 'loginScreen', 'registerScreen', 'dashboardScreen', 'createSurveyScreen', 'participateScreen'];
            screens.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        function showLogin() {
            showScreen('loginScreen');
        }

        function showRegister() {
            showScreen('registerScreen');
        }

        // í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
        function updatePoints() {
            const points = currentUser.points || 0;
            if (document.getElementById('userPoints')) {
                document.getElementById('userPoints').textContent = `ğŸ’° ${points.toLocaleString()} P`;
            }
            if (document.getElementById('userPoints2')) {
                document.getElementById('userPoints2').textContent = `ğŸ’° ${points.toLocaleString()} P`;
            }
            if (document.getElementById('userPoints3')) {
                document.getElementById('userPoints3').textContent = `ğŸ’° ${points.toLocaleString()} P`;
            }
            if (document.getElementById('userPointsDisplay')) {
                document.getElementById('userPointsDisplay').textContent = points.toLocaleString();
            }
        }

        // íšŒì›ê°€ì…
        function register() {
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const phone = document.getElementById('regPhone').value;
            const birthDate = document.getElementById('regBirthDate').value;
            const region = document.getElementById('regRegion').value;
            const job = document.getElementById('regJob').value;

            if (!name || !email || !password || !phone || !birthDate || !region || !job) {
                document.getElementById('registerMessage').innerHTML = '<div class="error-msg">ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>';
                return;
            }

            if (password.length < 8) {
                document.getElementById('registerMessage').innerHTML = '<div class="error-msg">ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.</div>';
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '[]');

            if (users.find(u => u.email === email)) {
                document.getElementById('registerMessage').innerHTML = '<div class="error-msg">ì´ë¯¸ ë“±ë¡ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.</div>';
                return;
            }

            const newUser = {
                id: Date.now().toString(),
                name, email, password, phone, birthDate, region, job,
                points: 1000, // ê°€ì… ì‹œ 1000 í¬ì¸íŠ¸ ì§€ê¸‰
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));

            document.getElementById('registerMessage').innerHTML = '<div class="success-msg">ğŸ‰ íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! 1,000Pê°€ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤!</div>';
            setTimeout(() => showLogin(), 2000);
        }

        // ë¡œê·¸ì¸
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                document.getElementById('loginMessage').innerHTML = '<div class="error-msg">ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</div>';
                return;
            }

            let users = JSON.parse(localStorage.getItem('users') || '[]');

            // í…ŒìŠ¤íŠ¸ ê³„ì • ìë™ ìƒì„±
            if (email === 'test@example.com' && !users.find(u => u.email === email)) {
                const testUser = {
                    id: 'test-user',
                    name: 'í…ŒìŠ¤í„°',
                    email: 'test@example.com',
                    password: 'password123',
                    phone: '010-1234-5678',
                    birthDate: '1990-01-01',
                    region: 'ì„œìš¸',
                    job: 'íšŒì‚¬ì›',
                    points: 5000,
                    createdAt: new Date().toISOString()
                };
                users.push(testUser);
                localStorage.setItem('users', JSON.stringify(users));
            }

            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showDashboard();
            } else {
                document.getElementById('loginMessage').innerHTML = '<div class="error-msg">ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>';
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showScreen('welcomeScreen');
        }

        // ëŒ€ì‹œë³´ë“œ
        function showDashboard() {
            showScreen('dashboardScreen');
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userInfo').innerHTML = `
                ğŸ“§ ${currentUser.email} | ğŸ“ ${currentUser.region} | ğŸ’¼ ${currentUser.job}
            `;

            updatePoints();
            updateDashboardStats();
            loadMySurveys();
            loadAvailableSurveys();
        }

        function updateDashboardStats() {
            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            const mySurveys = surveys.filter(s => s.creatorId === currentUser.id);
            const participations = JSON.parse(localStorage.getItem('participations') || '[]');
            const myParticipations = participations.filter(p => p.userId === currentUser.id);

            const availableSurveys = surveys.filter(s => {
                if (s.creatorId === currentUser.id) return false;
                if (myParticipations.find(p => p.surveyId === s.id)) return false;
                if (s.targetRegion && s.targetRegion !== currentUser.region) return false;
                if (s.targetJob && s.targetJob !== currentUser.job) return false;
                return true;
            });

            document.getElementById('mySurveysCount').textContent = mySurveys.length;
            document.getElementById('availableSurveysCount').textContent = availableSurveys.length;
            document.getElementById('completedSurveysCount').textContent = myParticipations.length;
        }

        function loadMySurveys() {
            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            const mySurveys = surveys.filter(s => s.creatorId === currentUser.id);
            const list = document.getElementById('mySurveysList');

            if (mySurveys.length === 0) {
                list.innerHTML = '<p style="color: #999; margin-top: 15px;">ì•„ì§ ë§Œë“  ì„¤ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            list.innerHTML = mySurveys.map(survey => `
                <div class="survey-item" onclick="viewMySurveyDetail('${survey.id}')">
                    <div class="survey-title">${survey.title}</div>
                    <div class="survey-desc">${survey.description}</div>
                    <div class="survey-info">
                        ëª©í‘œ: ${survey.targetResponses}ëª… |
                        ë³´ìƒ: ${survey.rewardPoints}P
                    </div>
                </div>
            `).join('');
        }

        function loadAvailableSurveys() {
            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            const participations = JSON.parse(localStorage.getItem('participations') || '[]');
            const myParticipations = participations.filter(p => p.userId === currentUser.id);

            const available = surveys.filter(s => {
                if (s.creatorId === currentUser.id) return false;
                if (myParticipations.find(p => p.surveyId === s.id)) return false;
                if (s.targetRegion && s.targetRegion !== currentUser.region) return false;
                if (s.targetJob && s.targetJob !== currentUser.job) return false;
                return true;
            });

            const list = document.getElementById('availableSurveysList');

            if (available.length === 0) {
                list.innerHTML = '<p style="color: #999; margin-top: 15px;">í˜„ì¬ ì°¸ì—¬ ê°€ëŠ¥í•œ ì„¤ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            list.innerHTML = available.map(survey => `
                <div class="survey-item" onclick="startSurveyParticipation('${survey.id}')">
                    <div class="survey-title">${survey.title} <span class="badge">ì°¸ì—¬ ê°€ëŠ¥</span></div>
                    <div class="survey-desc">${survey.description}</div>
                    <div class="survey-info">
                        ğŸ ë³´ìƒ: ${survey.rewardPoints}P <span class="badge badge-points">+${survey.rewardPoints}P</span>
                    </div>
                </div>
            `).join('');
        }

        // ì„¤ë¬¸ ìƒì„± í™”ë©´
        function showCreateSurvey() {
            showScreen('createSurveyScreen');
            updatePoints();
            questions = [];
            questionCounter = 0;
            document.getElementById('questionsContainer').innerHTML = '';
            addQuestion(); // ê¸°ë³¸ ì§ˆë¬¸ 1ê°œ ì¶”ê°€
        }

        // ì§ˆë¬¸ ì¶”ê°€
        function addQuestion() {
            questionCounter++;
            const questionId = questionCounter;

            const questionHtml = `
                <div class="question-item" id="question${questionId}">
                    <div class="question-header">
                        <h4>ì§ˆë¬¸ ${questionId}</h4>
                        <div class="question-controls">
                            <button type="button" class="btn btn-small btn-danger" onclick="removeQuestion(${questionId})">ì‚­ì œ</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ì§ˆë¬¸ ë‚´ìš©</label>
                        <input type="text" id="qText${questionId}" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label>ì§ˆë¬¸ ìœ í˜•</label>
                        <select id="qType${questionId}" onchange="updateQuestionType(${questionId})">
                            <option value="radio">ê°ê´€ì‹ (ë‹¨ì¼ì„ íƒ)</option>
                            <option value="checkbox">ì²´í¬ë°•ìŠ¤ (ë³µìˆ˜ì„ íƒ)</option>
                            <option value="select">ë“œë¡­ë‹¤ìš´</option>
                            <option value="text">ë‹¨ë‹µí˜•</option>
                            <option value="textarea">ì¥ë¬¸í˜•</option>
                        </select>
                    </div>
                    <div id="optionsContainer${questionId}" class="form-group">
                        <label>ì„ íƒì§€</label>
                        <div id="options${questionId}">
                            <div class="option-item">
                                <input type="text" class="option-input" placeholder="ì„ íƒì§€ 1">
                                <button type="button" class="btn btn-small" onclick="addOption(${questionId})">+</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="qRequired${questionId}" checked> í•„ìˆ˜ ì§ˆë¬¸
                        </label>
                    </div>
                </div>
            `;

            document.getElementById('questionsContainer').insertAdjacentHTML('beforeend', questionHtml);
        }

        // ì§ˆë¬¸ ì‚­ì œ
        function removeQuestion(questionId) {
            document.getElementById(`question${questionId}`).remove();
        }

        // ì§ˆë¬¸ ìœ í˜• ë³€ê²½
        function updateQuestionType(questionId) {
            const type = document.getElementById(`qType${questionId}`).value;
            const optionsContainer = document.getElementById(`optionsContainer${questionId}`);

            if (type === 'text' || type === 'textarea') {
                optionsContainer.style.display = 'none';
            } else {
                optionsContainer.style.display = 'block';
            }
        }

        // ì„ íƒì§€ ì¶”ê°€
        function addOption(questionId) {
            const container = document.getElementById(`options${questionId}`);
            const optionCount = container.children.length + 1;

            const optionHtml = `
                <div class="option-item">
                    <input type="text" class="option-input" placeholder="ì„ íƒì§€ ${optionCount}">
                    <button type="button" class="btn btn-small btn-danger" onclick="this.parentElement.remove()">-</button>
                </div>
            `;

            container.insertAdjacentHTML('beforeend', optionHtml);
        }

        // ì„¤ë¬¸ ìƒì„±
        function createSurvey() {
            const title = document.getElementById('surveyTitle').value;
            const description = document.getElementById('surveyDesc').value;
            const targetResponses = document.getElementById('surveyTarget').value;
            const rewardPoints = parseInt(document.getElementById('surveyRewardPoints').value) || 0;
            const targetRegion = document.getElementById('surveyTargetRegion').value;
            const targetJob = document.getElementById('surveyTargetJob').value;

            if (!title || !description) {
                document.getElementById('createMessage').innerHTML = '<div class="error-msg">ì œëª©ê³¼ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.</div>';
                return;
            }

            // ì§ˆë¬¸ ìˆ˜ì§‘
            const collectedQuestions = [];
            const questionElements = document.querySelectorAll('.question-item');

            questionElements.forEach((el, index) => {
                const id = el.id.replace('question', '');
                const text = document.getElementById(`qText${id}`).value;
                const type = document.getElementById(`qType${id}`).value;
                const required = document.getElementById(`qRequired${id}`).checked;

                if (!text) return;

                const question = {
                    id: index + 1,
                    type: type,
                    question: text,
                    required: required
                };

                // ì„ íƒì§€ê°€ í•„ìš”í•œ ìœ í˜•ì¸ ê²½ìš°
                if (type === 'radio' || type === 'checkbox' || type === 'select') {
                    const optionInputs = document.querySelectorAll(`#options${id} .option-input`);
                    const options = Array.from(optionInputs)
                        .map(input => input.value)
                        .filter(val => val.trim() !== '');

                    if (options.length === 0) {
                        alert(`ì§ˆë¬¸ ${index + 1}ì— ì„ íƒì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.`);
                        return;
                    }

                    question.options = options;
                }

                collectedQuestions.push(question);
            });

            if (collectedQuestions.length === 0) {
                document.getElementById('createMessage').innerHTML = '<div class="error-msg">ìµœì†Œ 1ê°œ ì´ìƒì˜ ì§ˆë¬¸ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.</div>';
                return;
            }

            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            const newSurvey = {
                id: Date.now().toString(),
                creatorId: currentUser.id,
                title, description, targetResponses, rewardPoints,
                targetRegion, targetJob,
                questions: collectedQuestions,
                createdAt: new Date().toISOString(),
                participants: 0
            };

            surveys.push(newSurvey);
            localStorage.setItem('surveys', JSON.stringify(surveys));

            document.getElementById('createMessage').innerHTML = '<div class="success-msg">ì„¤ë¬¸ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</div>';
            setTimeout(() => showDashboard(), 1500);
        }

        // ì„¤ë¬¸ ì°¸ì—¬ ì‹œì‘
        function startSurveyParticipation(surveyId) {
            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            const survey = surveys.find(s => s.id === surveyId);
            currentSurvey = survey;

            showScreen('participateScreen');
            updatePoints();

            document.getElementById('participateTitle').textContent = survey.title;
            document.getElementById('participateDesc').textContent = survey.description;
            document.getElementById('participateReward').innerHTML = `
                <strong>ğŸ’° ì°¸ì—¬ ë³´ìƒ: ${survey.rewardPoints} í¬ì¸íŠ¸</strong><br>
                <small>ì„¤ë¬¸ ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ í¬ì¸íŠ¸ê°€ ì§€ê¸‰ë©ë‹ˆë‹¤.</small>
            `;

            // ì§ˆë¬¸ ë Œë”ë§
            const questionsHtml = survey.questions.map(q => {
                let inputHtml = '';

                switch(q.type) {
                    case 'radio':
                        inputHtml = `
                            <div class="answer-form">
                                ${q.options.map((opt, idx) => `
                                    <label class="answer-option">
                                        <input type="radio" name="q${q.id}" value="${opt}" ${q.required ? 'required' : ''}>
                                        ${opt}
                                    </label>
                                `).join('')}
                            </div>
                        `;
                        break;
                    case 'checkbox':
                        inputHtml = `
                            <div class="answer-form">
                                ${q.options.map((opt, idx) => `
                                    <label class="answer-option">
                                        <input type="checkbox" name="q${q.id}" value="${opt}">
                                        ${opt}
                                    </label>
                                `).join('')}
                            </div>
                        `;
                        break;
                    case 'select':
                        inputHtml = `
                            <div class="answer-form">
                                <select name="q${q.id}" class="answer-input" ${q.required ? 'required' : ''}>
                                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                    ${q.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                                </select>
                            </div>
                        `;
                        break;
                    case 'text':
                        inputHtml = `
                            <div class="answer-form">
                                <input type="text" name="q${q.id}" class="answer-input" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”" ${q.required ? 'required' : ''}>
                            </div>
                        `;
                        break;
                    case 'textarea':
                        inputHtml = `
                            <div class="answer-form">
                                <textarea name="q${q.id}" class="answer-input" rows="4" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”" ${q.required ? 'required' : ''}></textarea>
                            </div>
                        `;
                        break;
                }

                return `
                    <div class="question-item">
                        <p><strong>ì§ˆë¬¸ ${q.id}. ${q.question}</strong> ${q.required ? '<span style="color: red;">*</span>' : ''}</p>
                        ${inputHtml}
                    </div>
                `;
            }).join('');

            document.getElementById('participateQuestions').innerHTML = questionsHtml;
        }

        // ì„¤ë¬¸ ì‘ë‹µ ì œì¶œ
        function submitSurveyAnswers() {
            const form = document.getElementById('participateForm');

            if (!form.checkValidity()) {
                alert('í•„ìˆ˜ ì§ˆë¬¸ì— ëª¨ë‘ ì‘ë‹µí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì‘ë‹µ ìˆ˜ì§‘
            const answers = {};
            currentSurvey.questions.forEach(q => {
                if (q.type === 'checkbox') {
                    const checked = Array.from(document.querySelectorAll(`input[name="q${q.id}"]:checked`))
                        .map(input => input.value);
                    answers[q.id] = checked;
                } else {
                    const input = document.querySelector(`[name="q${q.id}"]`);
                    if (input.type === 'radio') {
                        const selected = document.querySelector(`input[name="q${q.id}"]:checked`);
                        answers[q.id] = selected ? selected.value : '';
                    } else {
                        answers[q.id] = input.value;
                    }
                }
            });

            // ì°¸ì—¬ ê¸°ë¡ ì €ì¥
            const participations = JSON.parse(localStorage.getItem('participations') || '[]');
            participations.push({
                id: Date.now().toString(),
                surveyId: currentSurvey.id,
                userId: currentUser.id,
                answers: answers,
                completedAt: new Date().toISOString()
            });
            localStorage.setItem('participations', JSON.stringify(participations));

            // í¬ì¸íŠ¸ ì§€ê¸‰
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].points = (users[userIndex].points || 0) + currentSurvey.rewardPoints;
                localStorage.setItem('users', JSON.stringify(users));
                currentUser.points = users[userIndex].points;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }

            alert(`ğŸ‰ ì„¤ë¬¸ ì°¸ì—¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nğŸ’° ${currentSurvey.rewardPoints} í¬ì¸íŠ¸ê°€ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            showDashboard();
        }

        // ë‚´ ì„¤ë¬¸ ìƒì„¸ ë³´ê¸°
        function viewMySurveyDetail(surveyId) {
            const surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            const survey = surveys.find(s => s.id === surveyId);
            const participations = JSON.parse(localStorage.getItem('participations') || '[]');
            const surveyParticipations = participations.filter(p => p.surveyId === surveyId);

            alert(`ì„¤ë¬¸ ìƒì„¸ ì •ë³´\n\nì œëª©: ${survey.title}\nì°¸ì—¬ì ìˆ˜: ${surveyParticipations.length}ëª…\nëª©í‘œ: ${survey.targetResponses}ëª…\në³´ìƒ: ${survey.rewardPoints}P`);
        }

        function showMySurveys() {
            showDashboard();
        }

        function showAvailableSurveys() {
            showDashboard();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = init;
    </script>
</body>
</html>
